select cm.name from
(
Select 
--RECEIVED.SENDER_NAME, BRANCH.NAME as BRANCH_NAME,
--RECEIVED.FILE_DATE_OF_REPORT, 
--RECEIVED.FILE_CONTENT_START_DATE,
--RECEIVED.FILE_CONTENT_END_DATE, 
--RECEIVED.FILE_FREQ_DESC, 
--RECEIVED.RECEIVED_FILE_DATE,
--RECEIVED.RECEIVED_FILE_STATUS,
--BRANCH.ID1_VALUE, BRANCH.ID1_CODE,
--DETAIL.NDC_NBR, DETAIL.PRODUCT_INFO,
--DETAIL.QTY_DISPENSED, 
--DETAIL.MOST_RECENT_SHIP_DATE,
distinct(ACCOUNT.NAME)
--, ACCOUNT.ID1_VALUE, ACCOUNT.ID1_CODE, 
--ACCOUNT.ADDRESS1, ACCOUNT.ADDRESS2, ACCOUNT.CITY, ACCOUNT.STATE, ACCOUNT.ZIP,
--ACCOUNT.FIRST_NAME, ACCOUNT.LAST_NAME, ACCOUNT.PHYS_ADDRESS1, 
--ACCOUNT.PHYS_ADDRESS2, ACCOUNT.PHYS_CITY, ACCOUNT.PHYS_STATE, ACCOUNT.PHYS_ZIP
FROM CLOAD_STAGE.RECEIVED_FILES_ETL_V Received, CLOAD_STAGE.CLD_DETAIL_COOKED Detail, CLOAD_STAGE.CLD_ACCOUNT_COOKED Account, CLOAD_STAGE.CLD_BRANCH_COOKED Branch
WHERE Received.Received_File_ID = DETAIL.Received_File_ID 
AND ACCOUNT.CLD_ACCOUNT_COOKED_ID = DETAIL.CLD_ACCOUNT_COOKED_ID
AND BRANCH.CLD_BRANCH_COOKED_ID = ACCOUNT.CLD_BRANCH_COOKED_ID
AND RECEIVED.FILE_FREQUENCY = 'MT' 
and (RECEIVED.RECEIVED_FILE_STATUS_ID = '47' or RECEIVED.RECEIVED_FILE_STATUS_ID = '10')
and (ACCOUNT.NAME LIKE '%ONCOMED%'or ACCOUNT.NAME LIKE '%Oncomed%' 
OR ACCOUNT.NAME like '%ONCO360%' OR ACCOUNT.NAME LIKE '%Onco360%' 
OR ACCOUNT.NAME like '%ONCO 360%' OR ACCOUNT.NAME LIKE '%Onco 360%'
OR ACCOUNT.NAME LIKE '%ONCOMD%' OR ACCOUNT.NAME LIKE '%Oncomd%' 
OR ACCOUNT.NAME LIKE '%SINA DRUG%' OR ACCOUNT.NAME LIKE '%Sina Drug%' 
OR ACCOUNT.NAME LIKE '%ONC MED%' OR ACCOUNT.NAME LIKE '%Onc Med%' )
AND RECEIVED.SENDER_NAME !='Demo_%'
AND RECEIVED.FILE_DATE_OF_REPORT >= ('01SEP2023') and RECEIVED.FILE_DATE_OF_REPORT <= ('30SEP2023')
UNION ALL
Select 
--RECEIVED.SENDER_NAME, BRANCH.NAME as BRANCH_NAME,
--RECEIVED.FILE_DATE_OF_REPORT, 
--RECEIVED.FILE_CONTENT_START_DATE,
--RECEIVED.FILE_CONTENT_END_DATE, 
--RECEIVED.FILE_FREQ_DESC, 
--RECEIVED.RECEIVED_FILE_DATE,
--RECEIVED.RECEIVED_FILE_STATUS,
--BRANCH.ID1_VALUE, BRANCH.ID1_CODE,
--DETAIL.NDC_NBR, DETAIL.PRODUCT_INFO,
--DETAIL.QTY_DISPENSED, 
--DETAIL.MOST_RECENT_SHIP_DATE,
distinct(ACCOUNT.NAME)
--, ACCOUNT.ID1_VALUE, ACCOUNT.ID1_CODE, 
--ACCOUNT.ADDRESS1, ACCOUNT.ADDRESS2, ACCOUNT.CITY, ACCOUNT.STATE, ACCOUNT.ZIP,
--ACCOUNT.FIRST_NAME, ACCOUNT.LAST_NAME, ACCOUNT.PHYS_ADDRESS1, 
--ACCOUNT.PHYS_ADDRESS2, ACCOUNT.PHYS_CITY, ACCOUNT.PHYS_STATE, ACCOUNT.PHYS_ZIP
FROM CLOAD_STAGE.RECEIVED_FILES_ETL_V Received, CLOAD_STAGE.CLD_DETAIL_COOKED Detail, CLOAD_STAGE.CLD_ACCOUNT_COOKED Account, CLOAD_STAGE.CLD_BRANCH_COOKED Branch
WHERE Received.Received_File_ID = DETAIL.Received_File_ID 
AND ACCOUNT.CLD_ACCOUNT_COOKED_ID = DETAIL.CLD_ACCOUNT_COOKED_ID
AND BRANCH.CLD_BRANCH_COOKED_ID = ACCOUNT.CLD_BRANCH_COOKED_ID
AND RECEIVED.FILE_FREQUENCY = 'DY'
AND RECEIVED.SENDER_NAME <> 'Cardinal'
AND NOT (RECEIVED.SENDER_NAME IN ('ASD','Besse','OTN','ICS','Oncology Supply') AND DETAIL.MOST_RECENT_SHIP_DATE IN ('28-JUN-2020','29-JUN-2020','30-JUN-2020'))
and (RECEIVED.RECEIVED_FILE_STATUS_ID = '47' or RECEIVED.RECEIVED_FILE_STATUS_ID = '10')
and (ACCOUNT.NAME LIKE '%ONCOMED%'or ACCOUNT.NAME LIKE '%Oncomed%' 
OR ACCOUNT.NAME like '%ONCO360%' OR ACCOUNT.NAME LIKE '%Onco360%' 
OR ACCOUNT.NAME like '%ONCO 360%' OR ACCOUNT.NAME LIKE '%Onco 360%'
OR ACCOUNT.NAME LIKE '%ONCOMD%' OR ACCOUNT.NAME LIKE '%Oncomd%' 
OR ACCOUNT.NAME LIKE '%SINA DRUG%' OR ACCOUNT.NAME LIKE '%Sina Drug%' 
OR ACCOUNT.NAME LIKE '%ONC MED%' OR ACCOUNT.NAME LIKE '%Onc Med%' )
AND RECEIVED.SENDER_NAME !='Demo_%'
AND RECEIVED.FILE_DATE_OF_REPORT >= ('01SEP2023') and RECEIVED.FILE_DATE_OF_REPORT <= ('30SEP2023')
) pm
full outer join
(
Select 
--RECEIVED.SENDER_NAME, BRANCH.NAME as BRANCH_NAME,
--RECEIVED.FILE_DATE_OF_REPORT, 
--RECEIVED.FILE_CONTENT_START_DATE,
--RECEIVED.FILE_CONTENT_END_DATE, 
--RECEIVED.FILE_FREQ_DESC, 
--RECEIVED.RECEIVED_FILE_DATE,
--RECEIVED.RECEIVED_FILE_STATUS,
--BRANCH.ID1_VALUE, BRANCH.ID1_CODE,
--DETAIL.NDC_NBR, DETAIL.PRODUCT_INFO,
--DETAIL.QTY_DISPENSED, 
--DETAIL.MOST_RECENT_SHIP_DATE,
distinct(ACCOUNT.NAME)
--, ACCOUNT.ID1_VALUE, ACCOUNT.ID1_CODE, 
--ACCOUNT.ADDRESS1, ACCOUNT.ADDRESS2, ACCOUNT.CITY, ACCOUNT.STATE, ACCOUNT.ZIP,
--ACCOUNT.FIRST_NAME, ACCOUNT.LAST_NAME, ACCOUNT.PHYS_ADDRESS1, 
--ACCOUNT.PHYS_ADDRESS2, ACCOUNT.PHYS_CITY, ACCOUNT.PHYS_STATE, ACCOUNT.PHYS_ZIP
FROM CLOAD_STAGE.RECEIVED_FILES_ETL_V Received, CLOAD_STAGE.CLD_DETAIL_COOKED Detail, CLOAD_STAGE.CLD_ACCOUNT_COOKED Account, CLOAD_STAGE.CLD_BRANCH_COOKED Branch
WHERE Received.Received_File_ID = DETAIL.Received_File_ID 
AND ACCOUNT.CLD_ACCOUNT_COOKED_ID = DETAIL.CLD_ACCOUNT_COOKED_ID
AND BRANCH.CLD_BRANCH_COOKED_ID = ACCOUNT.CLD_BRANCH_COOKED_ID
AND RECEIVED.FILE_FREQUENCY = 'MT' 
and (RECEIVED.RECEIVED_FILE_STATUS_ID = '47' or RECEIVED.RECEIVED_FILE_STATUS_ID = '10')
and (ACCOUNT.NAME LIKE '%ONCOMED%'or ACCOUNT.NAME LIKE '%Oncomed%' 
OR ACCOUNT.NAME like '%ONCO360%' OR ACCOUNT.NAME LIKE '%Onco360%' 
OR ACCOUNT.NAME like '%ONCO 360%' OR ACCOUNT.NAME LIKE '%Onco 360%'
OR ACCOUNT.NAME LIKE '%ONCOMD%' OR ACCOUNT.NAME LIKE '%Oncomd%' 
OR ACCOUNT.NAME LIKE '%SINA DRUG%' OR ACCOUNT.NAME LIKE '%Sina Drug%' 
OR ACCOUNT.NAME LIKE '%ONC MED%' OR ACCOUNT.NAME LIKE '%Onc Med%' )
AND RECEIVED.SENDER_NAME !='Demo_%'
AND RECEIVED.FILE_DATE_OF_REPORT >= ('01OCT2023') and RECEIVED.FILE_DATE_OF_REPORT <= ('31OCT2023')
UNION ALL
Select 
--RECEIVED.SENDER_NAME, BRANCH.NAME as BRANCH_NAME,
--RECEIVED.FILE_DATE_OF_REPORT, 
--RECEIVED.FILE_CONTENT_START_DATE,
--RECEIVED.FILE_CONTENT_END_DATE, 
--RECEIVED.FILE_FREQ_DESC, 
--RECEIVED.RECEIVED_FILE_DATE,
--RECEIVED.RECEIVED_FILE_STATUS,
--BRANCH.ID1_VALUE, BRANCH.ID1_CODE,
--DETAIL.NDC_NBR, DETAIL.PRODUCT_INFO,
--DETAIL.QTY_DISPENSED, 
--DETAIL.MOST_RECENT_SHIP_DATE,
distinct(ACCOUNT.NAME)
--, ACCOUNT.ID1_VALUE, ACCOUNT.ID1_CODE, 
--ACCOUNT.ADDRESS1, ACCOUNT.ADDRESS2, ACCOUNT.CITY, ACCOUNT.STATE, ACCOUNT.ZIP,
--ACCOUNT.FIRST_NAME, ACCOUNT.LAST_NAME, ACCOUNT.PHYS_ADDRESS1, 
--ACCOUNT.PHYS_ADDRESS2, ACCOUNT.PHYS_CITY, ACCOUNT.PHYS_STATE, ACCOUNT.PHYS_ZIP
FROM CLOAD_STAGE.RECEIVED_FILES_ETL_V Received, CLOAD_STAGE.CLD_DETAIL_COOKED Detail, CLOAD_STAGE.CLD_ACCOUNT_COOKED Account, CLOAD_STAGE.CLD_BRANCH_COOKED Branch
WHERE Received.Received_File_ID = DETAIL.Received_File_ID 
AND ACCOUNT.CLD_ACCOUNT_COOKED_ID = DETAIL.CLD_ACCOUNT_COOKED_ID
AND BRANCH.CLD_BRANCH_COOKED_ID = ACCOUNT.CLD_BRANCH_COOKED_ID
AND RECEIVED.FILE_FREQUENCY = 'DY'
AND RECEIVED.SENDER_NAME <> 'Cardinal'
AND NOT (RECEIVED.SENDER_NAME IN ('ASD','Besse','OTN','ICS','Oncology Supply') AND DETAIL.MOST_RECENT_SHIP_DATE IN ('28-JUN-2020','29-JUN-2020','30-JUN-2020'))
and (RECEIVED.RECEIVED_FILE_STATUS_ID = '47' or RECEIVED.RECEIVED_FILE_STATUS_ID = '10')
and (ACCOUNT.NAME LIKE '%ONCOMED%'or ACCOUNT.NAME LIKE '%Oncomed%' 
OR ACCOUNT.NAME like '%ONCO360%' OR ACCOUNT.NAME LIKE '%Onco360%' 
OR ACCOUNT.NAME like '%ONCO 360%' OR ACCOUNT.NAME LIKE '%Onco 360%'
OR ACCOUNT.NAME LIKE '%ONCOMD%' OR ACCOUNT.NAME LIKE '%Oncomd%' 
OR ACCOUNT.NAME LIKE '%SINA DRUG%' OR ACCOUNT.NAME LIKE '%Sina Drug%' 
OR ACCOUNT.NAME LIKE '%ONC MED%' OR ACCOUNT.NAME LIKE '%Onc Med%' )
AND RECEIVED.SENDER_NAME !='Demo_%'
AND RECEIVED.FILE_DATE_OF_REPORT >= ('01OCT2023') and RECEIVED.FILE_DATE_OF_REPORT <= ('31OCT2023')
) cm
on
pm.name = cm.name
where pm.name is null
